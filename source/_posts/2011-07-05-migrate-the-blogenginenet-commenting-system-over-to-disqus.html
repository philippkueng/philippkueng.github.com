---
layout: post
title: "Migrate the BlogEngine.NET commenting system over to Disqus"
comments: true
---
<p><img src="/images/2011/7/DSC_6717.jpg" alt="comments" /></p>
<p>Offloading comments to a third party, namely <a href="http://disqus.com/">disqus</a>, is the initial step I&#8217;ll take for migrating my current blog to a static alternative called <a href="http://github.com/mojombo/jekyll/">Jekyll</a>. But more on my decision in a later post. Let&#8217;s focus on the steps necessary to get those comments up to disqus.</p>

<p><strong>Warning:</strong> Because after the migration the comments are getting injected into the page via Javascript, Google and the rest of the Search-Engine-Mafia won&#8217;t be able index them which basically means users won&#8217;t be able to search for comments in your post when using a search engine.</p>

<p><strong>Disclaimer:</strong> Actually all the tools and most steps used in this post are from <a href="http://blog.prabir.me/post/Migrating-Existing-BlogEngineNet-Comments-to-Disqus.aspx">Migrating Existing BlogEngine.Net Comments to Disqus</a>, however I ran into some issues while following the guide.</p>

<p>Now to the migration part, first of all we&#8217;ll need to extract the existing comments from your blog. For doing so we&#8217;ll use the <a href="http://blog.prabir.me/files/2010/5/DisqusUploaderWithBlogEngineExtensions.zip">CommentExporter BlogEngine Extension</a> by @prabirshrestha. Download and extract the extension, and upload the files inside the <strong>www</strong> directory into the according BlogEngine folders on your webserver. Then log into your blog and head over to the extensions tab of the administration dashboard. Make sure that the extension is <strong>enabled</strong> and then click the  <strong>edit</strong> link next to. In this new window select the option <strong>Intense Debate</strong> from the dropdown menu and continue by pressing Export Comments.</p>

<p>Once you have the file on your desktop open it with you favorite text-editor and check that there is no HTML encoded user name inside the <strong><name></strong> tags. If they&#8217;re encoded I strongly suggest rewrite them into their UTF-8 equivalent, otherwise they&#8217;re getting messed up by disqus.</p>

<p>Now go ahead and create a disqus account for your blog if you haven&#8217;t already.</p>

<p>Let&#8217;s import. Log into your disqus account and select the blog you want the comments to appear on. Then head over to the <strong>Tools</strong> tab and select <strong>Import / Export</strong> on the left hand side. Select IntenseDebate as the format then choose the file and hit <strong>Import</strong>. Depending on the number of comments you have it might take disqus a while to import all of them.</p>

<p>Next up we need to make a minor modification to the BlogEngine source. Open up your FTP browser, select the file post.aspx in the root of your BlogEngine installation and open it. In there remove the following line <strong>var disqus_url = &#8216;&#8230;&#8217;;</strong> and add the line <strong>var disqus_shortname = &#8216;fill in your disqus domain username&#8217;;</strong>.
The reason for this change is the following: Because we&#8217;ve extracted and uploaded the comments with the pretty url the built in disqus commenting will look for comments matching the ugly but unique guid url, which leads to none of the comments are ever showing up. Of course modifying the export extension, using regex in the text-editor or uploading a URL map to disqus will lead to similar results.</p>

<p>Finally you&#8217;re able to change the moderating system inside the comments tab of the BlogEngine administration dashboard to <strong>Moderated by Disqus</strong>. Now don&#8217;t forget the fill in the <strong>Disqus Website Short Name</strong> and then upgrade your blog by saving the changes.</p>

<p>One last thing to note, if you&#8217;re enabling comments for pages and you want the pretty urls for them too you&#8217;ll need to apply the same modifications for page.aspx as we did with post.aspx.</p>
